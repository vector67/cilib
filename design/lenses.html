<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../img/favicon.png">
<title>Immutable data Â· Cilib</title>
<link rel="stylesheet" href="../assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Cilib" class="md-header-nav__button md-logo">
<img src="../img/cilib_logo_transparent.png" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Cilib
</span>
<span class="md-header-nav__topic">
Immutable data
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/cirg-up/cilib"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
cirg-up/cilib
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<img src="../img/cilib_logo_transparent.png" width="24" height="24">
</span>
<a href="../index.html" title="Cilib">
Cilib
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/cirg-up/cilib"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
cirg-up/cilib
</div>
</a>

</div>
<label class="md-nav__link" style="padding-left: 12px">
<a href="../blog/index.html" title="Blog">
Blog
</a>
</label>
<label class="md-nav__link" style="padding-left: 12px; padding-bottom: 14px">
<a href="../api/cilib" target="_blank">API</a>
</label>
<ul>
  <li><a href="../design/index.html" class="page">Design</a>
  <ul>
    <li><a href="../design/overview.html" class="page">Overview</a></li>
    <li><a href="../design/lenses.html" class="active page">Immutable data</a></li>
    <li><a href="../design/position.html" class="page">Position</a></li>
    <li><a href="../design/entity.html" class="page">Entity</a></li>
    <li><a href="../design/rvar.html" class="page">RVar</a></li>
    <li><a href="../design/step.html" class="page">Step</a></li>
    <li><a href="../design/step_with_state.html" class="page">Step with state (aka StepS)</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Usage</a>
  <ul>
    <li><a href="../usage/gbestpso.html" class="page">Global Best PSO (GBestPSO)</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../design/lenses.html#immutable-data" class="header">Immutable data</a>
  <ul>
    <li><a href="../design/lenses.html#lenses" class="header">Lenses</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 2.0.1-22-g7e5938d
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../design/lenses.html#immutable-data" class="header">Immutable data</a>
  <ul>
    <li><a href="../design/lenses.html#lenses" class="header">Lenses</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#immutable-data" name="immutable-data" class="anchor"><span class="anchor-link"></span></a>Immutable data</h1>
<p>Immutable data is fantastic because it allows anyone to read the contents of the data and provides the security that the data will not change. In some cases, however, we would like to &ldquo;change&rdquo; some data value. Using immutable data means that we cannot change the value within a structure, instead we need to create an updated view of the data with the changes applied. This updated view creates new data, where the old data is still present and unchanged. It&rsquo;s recommended that the reader become familiar with persistent data structures and how they operate. Due to how persistent data structures update, by only changing the smallest number of references, the needed speed and efficiency is achieved.</p>
<p>Scala tries to help with respect to immutable data, by providing a convenience method on all <code>case class</code>es called <code>copy</code>. In situations where there is a nesting of case classes, potentially several levels, the updating of a value on the lower levels results in a bubbling-up process whereby each previous layer needs to update the reference to the new data in the lower layer. Although this is not difficult to do, the result is very verbose and extremely cumbersome for the user. It would be nice if this &ldquo;zooming&rdquo; update process was abstracted behind a data structure that would hide and automate the tedious process.</p>
<h1><a href="#lenses" name="lenses" class="anchor"><span class="anchor-link"></span></a>Lenses</h1>
<p>A <code>Lens</code> can, in the most trivial of ways, be seen as a simple getter and setter function pair. Within CIlib, several common lenses are available in order to extract information from the state of the <code>Entity</code>, or anything else for which a <code>Lens</code> has been defined. Because lenses allow the user to &ldquo;zoom&rdquo; onto data, potentially nested under many levels in another data structure, they are convenient as they allow for correctly updating the &ldquo;zoomed&rdquo; location in addition to extracting the value.</p>
<p>Trying to not re-invent the wheel, the [Monocle](<a href="http://julien-truffaut.github.io/Monocle/">http://julien-truffaut.github.io/Monocle/</a>) library provides the lens functionality. Lenses are structures that can also be composed together and are collectively called &ldquo;optics&rdquo;. Please refer to Monocle&rsquo;s documentation to learn more about lenses and optics. CIlib specific lens questions can be directed to the CIlib gitter room or IRC.</p>
<p>Lenses provide an API that is first and foremost, composition and lawful. This means that the various optics are well behaved and rules exist that govern their usage. Furthermore, different optics may be composed together to create new optics that are the combination of the original optics. This is obviously only possible if the provided types correctly line up.</p>
<p>Building on the usage of optics in general, we use a mechanism known as &ldquo;classy lens&rdquo; in Haskell. This mechanism prevents invalid usage, by letting the compiler fail based on the types being used. In the case of <code>Entity</code>, the compiler would look up instances, using it&rsquo;s implicit resolution rules, to obtain evidence for a typeclass with a given set of types, at compile time.</p>
<p>This provides an additional level of surety, that the data being passed to a function that requires evidence in order to extract some other piece of information for a given type. The scala compiler provides the evidence through the use of its implicit lookup mechanics. This may seem quite like a mouthful, but let&rsquo;s have a look a few examples that will hopefully make the usage clearer.</p>
<p>Based on the normally accepted usage of &ldquo;classy lenses&rdquo;, the typeclasses that expose the lenses are generally prefixed with <code>Has</code>. An example of this would be the <code>HasMemory</code> typeclass. The typeclass definition is simply:</p>
<pre><code>trait HasMemory[S,A] {
  def _memory: Lens[S, Position[A]]
}
</code></pre>
<p><code>HasMemory</code> defines a lens member, with the name <code>_memory</code> that can from a given <code>S</code> provide a <code>Position[A]</code>. There is absolutely no mention of what <code>S</code> is, or should be, but the typeclass allows for a set of instances that can actually provide this result. Within the context of the GA, Individuals are entities that <em>do not</em> maintain a memory; whereas within the PSO, Particles do maintain a memory of their previous best position (where <code>Position[A]</code> is a candidate solution of the problem space). The base module within the library already provides several optics for the user that operate on <code>Position[A]</code> instances, allowing for the extraction of the candidate solution, the fitness and the constraint violations. Other optics for other structures are also available.</p>
<p>The usage of these classy lenses will become even clearer when we look into what the generalization of Individual and Particle, the <em>Entity</em>.</p>
</div>
<div>
<a href="https://github.com/cirg-up/cilib/tree/master/docs/target/site-stage/design/lenses.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
2.0.1-22-g7e5938d
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../design/overview.html" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Overview
</span>
</div>
</a>
<a href="../design/position.html" title="Position" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Position
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.5165553b.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
